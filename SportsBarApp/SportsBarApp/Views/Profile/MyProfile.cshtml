@model SportsBarApp.Models.Profile
@{
    ViewBag.Title = "My Profile";
    Layout = "~/Views/Shared/_LayoutMyProfile.cshtml";

    var partial = "Details";
    if(ViewBag.Partial != null)
    {
        if (ViewBag.Partial.Equals("Edit"))
        {
            partial = "Edit";
        }
    }

}

@Html.Partial(partial)

@section scripts{
    <script type="text/javascript">
        $(function () {
            $('#search').autocomplete({ //Autocomplete for jQuery UI
                source: function (request, response) { // get function with request object who holds a term property and response that is a function
                    $.ajax({
                        url: '@Url.Action("Search", "Profile")',
                        dataType: 'json',
                        data: { search: request.term },
                        success: function (data) {
                            response($.map(data, function (item) {

                                return {
                                    value: item.Name,
                                    id: item.Friend.ProfileId
                                };
                            }))
                        }

                    })
                },
                minLength: 1,
                select: function (event, ui) {
                    window.location.pathname = "Profile/MyProfile/" + ui.item.id;
                    return false;
                },
            }).data("ui-autocomplete")._renderItem = function (ul, item) {

                return $('<div/>')
                    .data('ui-autocomplete-item', item)
                    .append("<li class='list-group-item'><div class='row'><div class='col-md-12 search-result-item'><div class='col-md-2'><img class='img-circle' src='http://placehold.it/40x40'></div><div class='col-md-10'>" + item.value + "</div></div></div></li>")
                    .appendTo(ul);
                };

            

        })
    </script>
}
